desc: Tests conversion to and from the RQL array type
tests:
    - py: r.expr([])
      js: ['r.expr([])', 'r([])']
      rb: r([])
      ot: []

    - py: r.expr([1])
      js: r([1])
      rb: r([1])
      ot: [1]

    - py: r.expr([1,2,3,4,5])
      js: r([1,2,3,4,5])
      rb: r.expr([1,2,3,4,5])
      ot: [1,2,3,4,5]

    - cd: r.expr([]).type_of()
      ot: "'ARRAY'"

    # test coercions
    - cd:
        - r.expr([1, 2]).coerce_to('string')
        - r.expr([1, 2]).coerce_to('STRING')
      ot: "'[1, 2]'"

    - cd: r.expr([1, 2]).coerce_to('array')
      ot: [1, 2]

    - cd: r.expr([1, 2]).coerce_to('number')
      ot: err('RqlRuntimeError', 'Cannot coerce ARRAY to NUMBER.', [0])

    - cd: r.expr([['a', 1], ['b', 2]]).coerce_to('object')
      ot: ({'a':1,'b':2})

    # Nested expression
    - cd: r.expr([r.expr(1)])
      ot: [1]

    - cd: r.expr([1,3,4]).insert_at(1, 2)
      ot: [1,2,3,4]
    - cd: r.expr([2,3]).insert_at(0, 1)
      ot: [1,2,3]
    - cd: r.expr([1,2,3]).insert_at(-1, 4)
      ot: [1,2,3,4]
    - cd: r.expr([1,2,3]).insert_at(3, 4)
      ot: [1,2,3,4]
    - cd: r.expr([1,2,3]).insert_at(4, 5)
      ot: "err('RqlRuntimeError', 'Index `4` out of bounds for array of size: `3`.')"
    - cd: r.expr([1,2,3]).insert_at(-4, -1)
      ot: "err('RqlCompileError', 'Index out of bounds: -4')"

    - cd: r.expr([1,4]).splice_at(1, [2,3])
      ot: [1,2,3,4]
    - cd: r.expr([3,4]).splice_at(0, [1,2])
      ot: [1,2,3,4]
    - cd: r.expr([1,2]).splice_at(2, [3,4])
      ot: [1,2,3,4]
    - cd: r.expr([1,2]).splice_at(-1, [3,4])
      ot: [1,2,3,4]
    - cd: r.expr([1,2]).splice_at(3, [3,4])
      ot: "err('RqlRuntimeError', 'Index `3` out of bounds for array of size: `2`.')"
    - cd: r.expr([1,2]).splice_at(-3, [3,4])
      ot: "err('RqlCompileError', 'Index out of bounds: -3')"

    - cd: r.expr([1,2,3,4]).delete_at(0)
      ot: [2,3,4]
    - cd: r.expr([1,2,3,4]).delete_at(-1)
      ot: [1,2,3]
    - cd: r.expr([1,2,3,4]).delete_at(1,2)
      ot: [1,4]
    - cd: r.expr([1,2,3,4]).delete_at(1,-2)
      ot: [1,4]
    - cd: r.expr([1,2,3,4]).delete_at(4)
      ot: "err('RqlRuntimeError', 'Index `4` out of bounds for array of size: `4`.')"
    - cd: r.expr([1,2,3,4]).delete_at(-5)
      ot: "err('RqlCompileError', 'Index out of bounds: -5')"

    - cd: r.expr([0,2,3]).change_at(0, 1)
      ot: [1,2,3]
    - cd: r.expr([1,0,3]).change_at(1, 2)
      ot: [1,2,3]
    - cd: r.expr([1,2,0]).change_at(2, 3)
      ot: [1,2,3]
    - cd: r.expr([1,2,3]).change_at(3, 4)
      ot: "err('RqlRuntimeError', 'Index `3` out of bounds for array of size: `3`.')"
    - cd: r.expr([1,2,3,4]).delete_at(-5)
      ot: "err('RqlCompileError', 'Index out of bounds: -5')"
